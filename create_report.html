<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Report - QA Reports System</title>
    <!-- Preload critical resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="preload"
        as="style" onload="this.rel='stylesheet'">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Main styles -->
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="/static/unified-nav.css">
    <link rel="stylesheet" href="/static/new_report.css">

    <!-- Theme manager (loads early) -->
    <script src="/static/theme-manager.js"></script>
    
    <!-- Navigation script -->
    <script src="/static/nav.js" defer></script>

    <!-- External libraries (defer non-critical) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"
        defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js" defer></script>

    <!-- Load non-critical CSS asynchronously -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
        media="print" onload="this.media='all'">
    <noscript>
        <link rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap">
    </noscript>
</head>

<body>
    <!-- Navigation Header -->
    <nav class="main-nav">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-rocket"></i> QA Reports System
            </div>
            
            <button class="mobile-menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
            
            <div class="nav-links">
                <a href="/dashboard" class="nav-link">
                    <i class="fas fa-tachometer-alt"></i>
                    <span class="nav-text">Dashboard</span>
                </a>
                <a href="/reports" class="nav-link">
                    <i class="fas fa-chart-line"></i>
                    <span class="nav-text">Reports</span>
                </a>
                <a href="/create-report" class="nav-link active">
                    <i class="fas fa-plus-circle"></i>
                    <span class="nav-text">New Report</span>
                </a>
                <a href="/manage" class="nav-link">
                    <i class="fas fa-cogs"></i>
                    <span class="nav-text">Manage Data</span>
                </a>
                <a href="/project-statistics" class="nav-link">
                    <i class="fas fa-chart-pie"></i>
                    <span class="nav-text">Statistics</span>
                </a>
            </div>
            
            <div class="nav-controls">
                <div class="nav-user">
                    <div class="nav-dropdown">
                        <button class="nav-dropdown-btn">
                            <i class="fas fa-user-circle"></i>
                            <span class="user-name">User</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="nav-dropdown-content">
                            <a href="/profile">
                                <i class="fas fa-user"></i>
                                Profile
                            </a>
                            <a href="/user-management" class="admin-only">
                                <i class="fas fa-users-cog"></i>
                                User Management
                            </a>
                            <a href="/logout">
                                <i class="fas fa-sign-out-alt"></i>
                                Logout
                            </a>
                        </div>
                    </div>
                </div>
                
                <button class="theme-toggle" onclick="toggleTheme()">
                    <i class="fas fa-sun" id="theme-icon"></i>
                    <span id="theme-text">Light</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Enhanced QA Form Page -->
    <div id="formPage" class="page active">
        <button class="mobile-menu-btn" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>

        <div class="form-container">
            <!-- Sidebar Navigation -->
            <nav class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h2><i class="fas fa-clipboard"></i> Report Sections</h2>
                    <button class="back-btn" onclick="window.location.href='/dashboard'"><i
                            class="fas fa-arrow-left"></i> Back to Dashboard</button>
                </div>
                <a href="#" class="nav-item active" onclick="showSection(0)"><i class="fas fa-info-circle"></i> General
                    Details</a>
                <a href="#" class="nav-item" onclick="showSection(1)"><i class="fas fa-file-alt"></i> Test Summary</a>
                <a href="#" class="nav-item" onclick="showSection(2)"><i class="fas fa-plus-square"></i> Additional
                    Info</a>
                <a href="#" class="nav-item" onclick="showSection(3)"><i class="fas fa-user-check"></i> User Stories</a>
                <a href="#" class="nav-item" onclick="showSection(4)"><i class="fas fa-vial"></i> Test Cases</a>
                <a href="#" class="nav-item" onclick="showSection(5)"><i class="fas fa-bug"></i> Issues Analysis</a>
                <a href="#" class="nav-item" onclick="showSection(6)"><i class="fas fa-bolt"></i> Enhancements</a>
                <a href="#" class="nav-item" onclick="showSection(7)"><i class="fas fa-star"></i> Evaluation</a>
                <a href="#" class="nav-item" onclick="showSection(8)"><i class="fas fa-robot"></i> Automation
                    Regression</a>
                <a href="#" class="nav-item" onclick="showSection(9)"><i class="fas fa-note-sticky"></i> QA Notes</a>
            </nav>

            <!-- Main Content -->
            <div class="main-content">
                <div class="dashboard-header">
                    <div class="header-content">
                        <h1 id="formTitle">Create Sprint Report</h1>
                        <p>Complete all sections to generate your comprehensive QA testing report</p>
                    </div>
                </div>

                <!-- Progress Bar -->
                <div class="progress-container">
                    <div class="progress-header">
                        <button class="sidebar-toggle-btn" onclick="toggleSidebar()" title="Toggle Sidebar">
                            <i class="fas fa-bars"></i>
                        </button>
                        <div class="progress-info">
                            <div class="progress-text" style="top:15%">
                                <span id="progressStep">Step 1 of 10</span>
                                <span id="progressTitle">General Details</span>
                            </div>
                            <div class="progress-percentage">
                                <span id="progressPercent">0%</span>
                            </div>
                        </div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-track">
                            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                        </div>
                        <div class="progress-steps">
                            <div class="step active" data-step="0">
                                <div class="step-circle">
                                    <i class="fas fa-info-circle"></i>
                                </div>
                                <span class="step-label">General</span>
                            </div>
                            <div class="step" data-step="1">
                                <div class="step-circle">
                                    <i class="fas fa-chart-bar"></i>
                                </div>
                                <span class="step-label">Summary</span>
                            </div>
                            <div class="step" data-step="2">
                                <div class="step-circle">
                                    <i class="fas fa-plus-square"></i>
                                </div>
                                <span class="step-label">Additional</span>
                            </div>
                            <div class="step" data-step="3">
                                <div class="step-circle">
                                    <i class="fas fa-user-check"></i>
                                </div>
                                <span class="step-label">Stories</span>
                            </div>
                            <div class="step" data-step="4">
                                <div class="step-circle">
                                    <i class="fas fa-vial"></i>
                                </div>
                                <span class="step-label">Tests</span>
                            </div>
                            <div class="step" data-step="5">
                                <div class="step-circle">
                                    <i class="fas fa-bug"></i>
                                </div>
                                <span class="step-label">Issues</span>
                            </div>
                            <div class="step" data-step="6">
                                <div class="step-circle">
                                    <i class="fas fa-bolt"></i>
                                </div>
                                <span class="step-label">Enhance</span>
                            </div>
                            <div class="step" data-step="7">
                                <div class="step-circle">
                                    <i class="fas fa-star"></i>
                                </div>
                                <span class="step-label">Evaluation</span>
                            </div>
                            <div class="step" data-step="8">
                                <div class="step-circle">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <span class="step-label">Automation</span>
                            </div>
                            <div class="step" data-step="9">
                                <div class="step-circle">
                                    <i class="fas fa-note-sticky"></i>
                                </div>
                                <span class="step-label">Notes</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="content-area">
                    <form id="qaReportForm">
                        <!-- Section 0: General Details -->
                        <div class="section active" id="section-0">
                            <h2 class="section-title"><i class="fas fa-info-circle"></i> General Details</h2>
                            <div class="general-details-grid">
                                <!-- Row 1: Report Name -->
                                <div class="form-group full-width">
                                    <label for="reportName">Report Name</label>
                                    <input type="text" id="reportName" name="reportName"
                                        placeholder="Enter custom report name"
                                        oninput="updateReportTitle()">
                                    <small class="field-hint">Leave blank to use default name [reporttype-Portfolio-project-date-sprint-cyclenumber]</small>
                                </div>

                                <!-- Row 2: Portfolio and Project -->
                                <div class="form-group">
                                    <label for="portfolioName">Portfolio Name</label>
                                    <select id="portfolioName" name="portfolioName"
                                        onchange="onPortfolioSelection()">
                                        <option value="">Select Portfolio</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="projectName">Project Name</label>
                                    <select id="projectName" name="projectName" onchange="onProjectSelection()">
                                        <option value="">Select Project</option>
                                    </select>
                                </div>

                                <!-- Row 3: Report Date and Test Environment -->
                                <div class="form-group">
                                    <label for="reportDate">Report Date</label>
                                    <input type="text" id="reportDate" name="reportDate"
                                        pattern="\d{2}-\d{2}-\d{4}" placeholder="dd-mm-yyyy">
                                </div>
                                <div class="form-group">
                                    <label for="testEnvironment">Test Environment</label>
                                    <select id="testEnvironment" name="testEnvironment">
                                        <option value="">Select Environment</option>
                                        <option value="local">Local</option>
                                        <option value="demo">Demo</option>
                                        <option value="dev">Dev</option>
                                        <option value="stage">Stage</option>
                                        <option value="uat">UAT</option>
                                        <option value="pre-production">Pre-production</option>
                                        <option value="production">Production</option>
                                    </select>
                                </div>

                                <!-- Row 4: Sprint Number and Cycle Number -->
                                <div class="form-group">
                                    <label for="sprintNumber">Sprint Number</label>
                                    <input type="number" id="sprintNumber" name="sprintNumber" min="1"
                                        placeholder="Enter sprint number">
                                </div>
                                <div class="form-group">
                                    <label for="cycleNumber">Cycle Number</label>
                                    <input type="number" id="cycleNumber" name="cycleNumber" min="1"
                                        placeholder="Enter cycle number">
                                </div>

                                <!-- Row 5: Release Number and Report Version -->
                                <div class="form-group">
                                    <label for="releaseNumber">Release Number</label>
                                    <input type="text" id="releaseNumber" name="releaseNumber"
                                        placeholder="e.g., R1.0, R2.1">
                                </div>
                                <div class="form-group">
                                    <label for="reportVersion">Report Version</label>
                                    <input type="number" id="reportVersion" name="reportVersion"
                                        placeholder="3" value="3" min="1" step="1">
                                </div>
                            </div>
                        </div>

                        <!-- Section 1: Test Summary -->
                        <div class="section" id="section-1">
                            <h2 class="section-title"><i class="fas fa-chart-bar"></i> Test Summary & Status</h2>
                            <div class="test-summary-layout">
                                <div class="test-summary-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-file-alt"></i>
                                        <h3>Test Summary & Status</h3>
                                    </div>
                                    <div class="info-card-v2-content">
                                        <div class="form-group">
                                            <label for="testSummary">Test Summary</label>
                                            <textarea id="testSummary" name="testSummary"
                                                placeholder="Provide a comprehensive summary of the testing activities..."
                                                rows="6"></textarea>
                                        </div>
                                        <div class="form-group">
                                            <label for="testingStatus">Testing Status</label>
                                            <select id="testingStatus" name="testingStatus">
                                                <option value="">Select Status</option>
                                                <option value="passed"><i class="fas fa-check-circle"></i> Passed
                                                </option>
                                                <option value="passed-with-issues"><i
                                                        class="fas fa-exclamation-triangle"></i> Passed with Issues
                                                </option>
                                                <option value="failed"><i class="fas fa-times-circle"></i> Failed
                                                </option>
                                                <option value="blocked"><i class="fas fa-ban"></i> Blocked</option>
                                                <option value="cancelled"><i class="fas fa-trash-alt"></i> Cancelled
                                                </option>
                                                <option value="deferred"><i class="fas fa-pause"></i> Deferred</option>
                                                <option value="not-testable"><i class="fas fa-question-circle"></i> Not
                                                    Testable</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="metrics-table-card test-summary-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-chart-line"></i>
                                        <h3>Testing Metrics (Auto-Calculated)</h3>
                                    </div>
                                    <div class="info-card-v2-content">
                                        <table class="data-table">
                                            <thead>
                                                <tr>
                                                    <th>Metric</th>
                                                    <th>Value</th>
                                                    <th>Source</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td><strong><i class="fas fa-user-check"></i> User
                                                            Stories</strong><br><small>Auto-calculated from section
                                                            4</small></td>
                                                    <td><input type="number" id="userStoriesMetric"
                                                            name="userStoriesMetric" readonly class="readonly-field">
                                                    </td>
                                                    <td><small>Sum of all user story statuses</small></td>
                                                </tr>
                                                <tr>
                                                    <td><strong><i class="fas fa-flask"></i> Test
                                                            Cases</strong><br><small>Auto-calculated from section
                                                            5</small></td>
                                                    <td><input type="number" id="testCasesMetric" name="testCasesMetric"
                                                            readonly class="readonly-field"></td>
                                                    <td><small>Sum of all test case statuses</small></td>
                                                </tr>
                                                <tr>
                                                    <td><strong><i class="fas fa-bug"></i>
                                                            Issues</strong><br><small>Auto-calculated from section
                                                            6</small></td>
                                                    <td><input type="number" id="issuesMetric" name="issuesMetric"
                                                            readonly class="readonly-field"></td>
                                                    <td><small>Sum of all issue priorities</small></td>
                                                </tr>
                                                <tr>
                                                    <td><strong><i class="fas fa-bolt"></i>
                                                            Enhancements</strong><br><small>Auto-calculated from section
                                                            7</small></td>
                                                    <td><input type="number" id="enhancementsMetric"
                                                            name="enhancementsMetric" readonly class="readonly-field">
                                                    </td>
                                                    <td><small>Sum of all enhancement statuses</small></td>
                                                </tr>
                                                <tr>
                                                    <td><strong><i class="fas fa-chart-bar"></i> QA Notes
                                                            Count</strong><br><small>Auto-calculated from section
                                                            8</small></td>
                                                    <td><input type="number" name="qaNotesMetric" id="qaNotesMetric"
                                                            min="0" placeholder="0" readonly class="readonly-field">
                                                    </td>
                                                    <td><small>Number of QA notes</small></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Section 2: Additional Information -->
                        <div class="section" id="section-2">
                            <h2 class="section-title"><i class="fas fa-info-circle"></i> Additional Information</h2>

                            <!-- Modern 2x2 Grid Layout for Additional Information Cards -->
                            <div class="additional-info-layout">
                                <!-- Row 1 -->
                                <div class="info-card-v2 additional-info-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-clipboard-list"></i>
                                        <h3>Request Information</h3>
                                        <button type="button" class="card-btn" onclick="showRequestModal()">
                                            <i class="fas fa-plus"></i> Add Request
                                        </button>
                                    </div>
                                    <div class="info-card-v2-content">
                                        <div class="dynamic-list" id="requestList">
                                            <div class="empty-state">No requests added yet. Click "Add Request" to get
                                                started.</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="info-card-v2 additional-info-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-hammer"></i>
                                        <h3>Build Information</h3>
                                        <button type="button" class="card-btn" onclick="showBuildModal()">
                                            <i class="fas fa-plus"></i> Add Build
                                        </button>
                                    </div>
                                    <div class="info-card-v2-content">
                                        <div class="dynamic-list" id="buildList">
                                            <div class="empty-state">No builds added yet. Click "Add Build" to get
                                                started.</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Row 2 -->
                                <div class="info-card-v2 additional-info-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-user-cog"></i>
                                        <h3>Tester(s) Information</h3>
                                        <button type="button" class="card-btn" onclick="showTesterModal()">
                                            <i class="fas fa-user-plus"></i> Select Tester
                                        </button>
                                    </div>
                                    <div class="info-card-v2-content">
                                        <div class="dynamic-list" id="testerList">
                                            <div class="empty-state">No testers added yet. Click "Add/Select Tester" to
                                                get started.</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="info-card-v2 additional-info-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-users"></i>
                                        <h3>Team Members</h3>
                                        <button type="button" class="card-btn" onclick="showTeamMemberModal()">
                                            <i class="fas fa-users"></i> Select Team Member
                                        </button>
                                    </div>
                                    <div class="info-card-v2-content">
                                        <div class="dynamic-list" id="teamMemberList">
                                            <div class="empty-state">No team members added yet.</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Section 3: User Stories -->
                        <div class="section" id="section-3">
                            <h2 class="section-title"><i class="fas fa-user-check"></i> User Stories Analysis</h2>

                            <div class="analysis-layout">
                                <div class="analysis-table-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-chart-bar"></i>
                                        <h3>User Stories Summary</h3>
                                    </div>
                                    <div class="info-card-v2-content">
                                        <table class="data-table" id="userStoriesTable">
                                            <thead>
                                                <tr>
                                                    <th>Status</th>
                                                    <th>Count</th>
                                                    <th>Percentage</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td><strong>Total Number of Stories</strong></td>
                                                    <td><input type="number" id="totalStories" min="0" placeholder="0"
                                                            readonly class="readonly-field calculated-total"></td>
                                                    <td class="percentage-cell">100%</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-check-circle text-success"></i> Passed</td>
                                                    <td><input type="number" id="passedStories" name="passedUserStories"
                                                            min="0" placeholder="0" oninput="calculatePercentages()">
                                                    </td>
                                                    <td class="percentage-cell" id="passedPercentage">0%</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-exclamation-triangle text-warning"></i> Passed
                                                        with Issue/s</td>
                                                    <td><input type="number" id="passedWithIssuesStories"
                                                            name="passedWithIssuesUserStories" min="0" placeholder="0"
                                                            oninput="calculatePercentages()"></td>
                                                    <td class="percentage-cell" id="passedWithIssuesPercentage">0%</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-times-circle text-danger"></i> Failed</td>
                                                    <td><input type="number" id="failedStories" name="failedUserStories"
                                                            min="0" placeholder="0" oninput="calculatePercentages()">
                                                    </td>
                                                    <td class="percentage-cell" id="failedPercentage">0%</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-ban text-warning"></i> Blocked</td>
                                                    <td><input type="number" id="blockedStories"
                                                            name="blockedUserStories" min="0" placeholder="0"
                                                            oninput="calculatePercentages()"></td>
                                                    <td class="percentage-cell" id="blockedPercentage">0%</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-trash-alt text-danger"></i> Cancelled</td>
                                                    <td><input type="number" id="cancelledStories"
                                                            name="cancelledUserStories" min="0" placeholder="0"
                                                            oninput="calculatePercentages()"></td>
                                                    <td class="percentage-cell" id="cancelledPercentage">0%</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-pause"></i> Deferred</td>
                                                    <td><input type="number" id="deferredStories"
                                                            name="deferredUserStories" min="0" placeholder="0"
                                                            oninput="calculatePercentages()"></td>
                                                    <td class="percentage-cell" id="deferredPercentage">0%</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-question-circle text-info"></i> Not Testable
                                                    </td>
                                                    <td><input type="number" id="notTestableStories"
                                                            name="notTestableUserStories" min="0" placeholder="0"
                                                            oninput="calculatePercentages()"></td>
                                                    <td class="percentage-cell" id="notTestablePercentage">0%</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <div class="analysis-chart-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-chart-pie"></i>
                                        <h3>User Stories Distribution</h3>
                                    </div>
                                    <div class="info-card-v2-content">
                                        <div class="chart-container">
                                            <canvas id="userStoriesChart" width="400" height="400"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Section 4: Test Cases -->
                        <div class="section" id="section-4">
                            <h2 class="section-title"><i class="fas fa-flask"></i> Test Cases Analysis</h2>

                            <div class="analysis-layout">
                                <div class="analysis-table-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-chart-bar"></i>
                                        <h3>Test Cases Summary</h3>
                                    </div>
                                    <div class="info-card-v2-content">
                                        <table class="data-table" id="testCasesTable">
                                            <thead>
                                                <tr>
                                                    <th>Status</th>
                                                    <th>Count</th>
                                                    <th>Percentage</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td><strong>Total Number of Test Cases</strong></td>
                                                    <td><input type="number" id="totalTestCases" min="0" placeholder="0"
                                                            readonly class="readonly-field calculated-total"></td>
                                                    <td class="percentage-cell">100%</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-check-circle text-success"></i> Passed</td>
                                                    <td><input type="number" id="passedTestCases" name="passedTestCases"
                                                            min="0" placeholder="0"
                                                            oninput="calculateTestCasesPercentages()"></td>
                                                    <td class="percentage-cell" id="passedTestCasesPercentage">0%</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-exclamation-triangle text-warning"></i> Passed
                                                        with Issue/s</td>
                                                    <td><input type="number" id="passedWithIssuesTestCases"
                                                            name="passedWithIssuesTestCases" min="0" placeholder="0"
                                                            oninput="calculateTestCasesPercentages()"></td>
                                                    <td class="percentage-cell"
                                                        id="passedWithIssuesTestCasesPercentage">0%</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-times-circle text-danger"></i> Failed</td>
                                                    <td><input type="number" id="failedTestCases" name="failedTestCases"
                                                            min="0" placeholder="0"
                                                            oninput="calculateTestCasesPercentages()"></td>
                                                    <td class="percentage-cell" id="failedTestCasesPercentage">0%</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-ban text-warning"></i> Blocked</td>
                                                    <td><input type="number" id="blockedTestCases"
                                                            name="blockedTestCases" min="0" placeholder="0"
                                                            oninput="calculateTestCasesPercentages()"></td>
                                                    <td class="percentage-cell" id="blockedTestCasesPercentage">0%</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-trash-alt text-danger"></i> Cancelled</td>
                                                    <td><input type="number" id="cancelledTestCases"
                                                            name="cancelledTestCases" min="0" placeholder="0"
                                                            oninput="calculateTestCasesPercentages()"></td>
                                                    <td class="percentage-cell" id="cancelledTestCasesPercentage">0%
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-pause"></i> Deferred</td>
                                                    <td><input type="number" id="deferredTestCases"
                                                            name="deferredTestCases" min="0" placeholder="0"
                                                            oninput="calculateTestCasesPercentages()"></td>
                                                    <td class="percentage-cell" id="deferredTestCasesPercentage">0%</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-question-circle text-info"></i> Not Testable
                                                    </td>
                                                    <td><input type="number" id="notTestableTestCases"
                                                            name="notTestableTestCases" min="0" placeholder="0"
                                                            oninput="calculateTestCasesPercentages()"></td>
                                                    <td class="percentage-cell" id="notTestableTestCasesPercentage">0%
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <div class="analysis-chart-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-chart-pie"></i>
                                        <h3>Test Cases Distribution</h3>
                                    </div>
                                    <div class="info-card-v2-content">
                                        <div class="chart-container">
                                            <canvas id="testCasesChart" width="400" height="400"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Section 5: Issues Analysis -->
                        <div class="section" id="section-5">
                            <h2 class="section-title"><i class="fas fa-bug"></i> Issues Analysis</h2>

                            <div class="issues-analysis-layout">
                                <div class="issues-priority-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-exclamation-triangle"></i>
                                        <h3>Issues by Priority</h3>
                                    </div>
                                    <div class="issues-content-layout">
                                        <div class="issues-table-section">
                                            <table class="data-table" id="issuesPriorityTable">
                                                <thead>
                                                    <tr>
                                                        <th>Priority</th>
                                                        <th>Count</th>
                                                        <th>Percentage</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td><strong>Total Issues</strong></td>
                                                        <td><input type="number" id="totalIssues" min="0"
                                                                placeholder="0" readonly
                                                                class="readonly-field calculated-total"></td>
                                                        <td class="percentage-cell">100%</td>
                                                    </tr>
                                                    <tr>
                                                        <td><i class="fas fa-circle text-danger"></i> Critical</td>
                                                        <td><input type="number" id="criticalIssues"
                                                                name="criticalIssues" min="0" placeholder="0"
                                                                oninput="calculateIssuesPercentages()"></td>
                                                        <td class="percentage-cell" id="criticalIssuesPercentage">0%
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td><i class="fas fa-circle text-warning"></i> High</td>
                                                        <td><input type="number" id="highIssues" name="highIssues"
                                                                min="0" placeholder="0"
                                                                oninput="calculateIssuesPercentages()"></td>
                                                        <td class="percentage-cell" id="highIssuesPercentage">0%</td>
                                                    </tr>
                                                    <tr>
                                                        <td><i class="fas fa-circle text-info"></i> Medium</td>
                                                        <td><input type="number" id="mediumIssues" name="mediumIssues"
                                                                min="0" placeholder="0"
                                                                oninput="calculateIssuesPercentages()"></td>
                                                        <td class="percentage-cell" id="mediumIssuesPercentage">0%</td>
                                                    </tr>
                                                    <tr>
                                                        <td><i class="fas fa-circle text-success"></i> Low</td>
                                                        <td><input type="number" id="lowIssues" name="lowIssues" min="0"
                                                                placeholder="0" oninput="calculateIssuesPercentages()">
                                                        </td>
                                                        <td class="percentage-cell" id="lowIssuesPercentage">0%</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="issues-chart-section">
                                            <div class="chart-container">
                                                <canvas id="issuesPriorityChart" width="400" height="300"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="issues-status-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-chart-bar"></i>
                                        <h3>Issues by Status</h3>
                                    </div>
                                    <div class="issues-content-layout">
                                        <div class="issues-table-section">
                                            <table class="data-table" id="issuesStatusTable">
                                                <thead>
                                                    <tr>
                                                        <th>Status</th>
                                                        <th>Count</th>
                                                        <th>Percentage</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td><i class="fas fa-plus-circle text-primary"></i> New</td>
                                                        <td><input type="number" id="newIssues" name="newIssues" min="0"
                                                                placeholder="0"
                                                                oninput="calculateIssuesStatusPercentages()"></td>
                                                        <td class="percentage-cell" id="newIssuesPercentage">0%</td>
                                                    </tr>
                                                    <tr>
                                                        <td><i class="fas fa-check-circle text-success"></i> Fixed</td>
                                                        <td><input type="number" id="fixedIssues" name="fixedIssues"
                                                                min="0" placeholder="0"
                                                                oninput="calculateIssuesStatusPercentages()"></td>
                                                        <td class="percentage-cell" id="fixedIssuesPercentage">0%</td>
                                                    </tr>
                                                    <tr>
                                                        <td><i class="fas fa-times-circle text-danger"></i> Not Fixed
                                                        </td>
                                                        <td><input type="number" id="notFixedIssues"
                                                                name="notFixedIssues" min="0" placeholder="0"
                                                                oninput="calculateIssuesStatusPercentages()"></td>
                                                        <td class="percentage-cell" id="notFixedIssuesPercentage">0%
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td><i class="fas fa-redo text-warning"></i> Re-opened</td>
                                                        <td><input type="number" id="reopenedIssues"
                                                                name="reopenedIssues" min="0" placeholder="0"
                                                                oninput="calculateIssuesStatusPercentages()"></td>
                                                        <td class="percentage-cell" id="reopenedIssuesPercentage">0%
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td><i class="fas fa-pause"></i> Deferred</td>
                                                        <td><input type="number" id="deferredIssues"
                                                                name="deferredIssues" min="0" placeholder="0"
                                                                oninput="calculateIssuesStatusPercentages()"></td>
                                                        <td class="percentage-cell" id="deferredIssuesPercentage">0%
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="issues-chart-section">
                                            <div class="chart-container">
                                                <canvas id="issuesStatusChart" width="400" height="300"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Section 6: Enhancements -->
                        <div class="section" id="section-6">
                            <h2 class="section-title"><i class="fas fa-bolt"></i> Enhancements Analysis</h2>

                            <div class="enhancements-layout">
                                <div class="enhancements-table-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-chart-bar"></i>
                                        <h3>Enhancements Summary</h3>
                                    </div>
                                    <div class="info-card-v2-content">
                                        <table class="data-table" id="enhancementsTable">
                                            <thead>
                                                <tr>
                                                    <th>Status</th>
                                                    <th>Count</th>
                                                    <th>Percentage</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td><strong>Total Enhancements</strong></td>
                                                    <td><input type="number" id="totalEnhancements" min="0"
                                                            placeholder="0" readonly
                                                            class="readonly-field calculated-total"></td>
                                                    <td class="percentage-cell">100%</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-plus-circle text-primary"></i> New</td>
                                                    <td><input type="number" id="newEnhancements" name="newEnhancements"
                                                            min="0" placeholder="0"
                                                            oninput="calculateEnhancementsPercentages()"></td>
                                                    <td class="percentage-cell" id="newEnhancementsPercentage">0%</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-check-circle text-success"></i> Implemented
                                                    </td>
                                                    <td><input type="number" id="implementedEnhancements"
                                                            name="implementedEnhancements" min="0" placeholder="0"
                                                            oninput="calculateEnhancementsPercentages()"></td>
                                                    <td class="percentage-cell" id="implementedEnhancementsPercentage">
                                                        0%</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-star text-warning"></i> Exists</td>
                                                    <td><input type="number" id="existsEnhancements"
                                                            name="existsEnhancements" min="0" placeholder="0"
                                                            oninput="calculateEnhancementsPercentages()"></td>
                                                    <td class="percentage-cell" id="existsEnhancementsPercentage">0%
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <div class="enhancements-chart-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-chart-pie"></i>
                                        <h3>Enhancements Distribution</h3>
                                    </div>
                                    <div class="info-card-v2-content">
                                        <div class="chart-container">
                                            <canvas id="enhancementsChart" width="400" height="400"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Section 7: Evaluation -->
                        <div class="section" id="section-7">
                            <h2 class="section-title"><i class="fas fa-star"></i> Evaluation</h2>
                            
                            <!-- Part 1: Evaluation Criteria (Expandable) -->
                            <div class="evaluation-criteria-card">
                                <div class="criteria-header" onclick="toggleEvaluationCriteria()">
                                    <div class="criteria-header-content">
                                        <i class="fas fa-list-check"></i>
                                        <h3>Evaluation Criteria</h3>
                                    </div>
                                    <i class="fas fa-chevron-down criteria-toggle-icon" id="criteriaToggleIcon"></i>
                                </div>
                                <div class="criteria-content" id="criteriaContent">
                                    <div class="criteria-text-section">
                                        <div class="criteria-item">
                                            <h4>Involvement</h4>
                                            <p>The QA team is testing within the sprint and is involved in all the scrum ceremonies.</p>
                                        </div>
                                        <div class="criteria-item">
                                            <h4>Requirements Quality</h4>
                                            <p>The quality of the user stories and documents.</p>
                                        </div>
                                        <div class="criteria-item">
                                            <h4>QA Plan Review</h4>
                                            <p>Review the QA plan that the vendor will provide.</p>
                                        </div>
                                        <div class="criteria-item">
                                            <h4>UX</h4>
                                            <p>The user flow (it will be checked against the Ministry's evaluation criteria).</p>
                                        </div>
                                        <div class="criteria-item">
                                            <h4>Cooperation</h4>
                                            <p>This will measure the cooperation between QA, Product Owners, and vendors.</p>
                                        </div>
                                        <div class="criteria-item">
                                            <h4>Critical Bugs</h4>
                                            <p>1 cycle (must be fixed on the next cycle of the bug detection).</p>
                                        </div>
                                        <div class="criteria-item">
                                            <h4>High Bugs</h4>
                                            <p>1 cycle (must be fixed on the next cycle of the bug detection).</p>
                                        </div>
                                        <div class="criteria-item">
                                            <h4>Medium Bugs</h4>
                                            <p>2 cycles (must be fixed on the second cycle of the bug detection).</p>
                                        </div>
                                        <div class="criteria-item">
                                            <h4>Low Bugs</h4>
                                            <p>We start counting once the number of detected low bugs => 10.</p>
                                        </div>
                                    </div>
                                    
                                    <!-- Criteria Weight Table -->
                                    <div class="criteria-weight-table">
                                        <h4>Evaluation Criteria & Weights</h4>
                                        <table class="data-table criteria-table">
                                            <thead>
                                                <tr>
                                                    <th>Criteria</th>
                                                    <th>Weight</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr><td>Involvement</td><td>20%</td></tr>
                                                <tr><td>Requirements Quality</td><td>10%</td></tr>
                                                <tr><td>QA Plan Review</td><td>5%</td></tr>
                                                <tr><td>UX</td><td>5%</td></tr>
                                                <tr><td>Cooperation</td><td>10%</td></tr>
                                                <tr><td>Critical Bugs</td><td>0%</td></tr>
                                                <tr><td>High Bugs</td><td>15%</td></tr>
                                                <tr><td>Medium Bugs</td><td>10%</td></tr>
                                                <tr><td>Low Bugs</td><td>5%</td></tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <!-- Part 2: Evaluation Scores -->
                            <div class="evaluation-scores-layout">
                                <div class="evaluation-scores-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-chart-line"></i>
                                        <h3>Evaluation Scores</h3>
                                    </div>
                                    <div class="info-card-v2-content">
                                        <table class="data-table evaluation-scores-table" id="evaluationScoresTable">
                                            <thead>
                                                <tr>
                                                    <th>Criteria</th>
                                                    <th>Max Score</th>
                                                    <th>Score</th>
                                                    <th>Reason</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td><strong>Involvement</strong></td>
                                                    <td>20</td>
                                                    <td><input type="number" id="involvementScore" name="involvementScore" min="0" max="20" placeholder="0" oninput="calculateFinalScore()"></td>
                                                    <td><input type="text" id="involvementReason" name="involvementReason" placeholder="Enter reason"></td>
                                                </tr>
                                                <tr>
                                                    <td><strong>Requirements Quality</strong></td>
                                                    <td>10</td>
                                                    <td><input type="number" id="requirementsQualityScore" name="requirementsQualityScore" min="0" max="10" placeholder="0" oninput="calculateFinalScore()"></td>
                                                    <td><input type="text" id="requirementsQualityReason" name="requirementsQualityReason" placeholder="Enter reason"></td>
                                                </tr>
                                                <tr>
                                                    <td><strong>QA Plan Review</strong></td>
                                                    <td>5</td>
                                                    <td><input type="number" id="qaPlanReviewScore" name="qaPlanReviewScore" min="0" max="5" placeholder="0" oninput="calculateFinalScore()"></td>
                                                    <td><input type="text" id="qaPlanReviewReason" name="qaPlanReviewReason" placeholder="Enter reason"></td>
                                                </tr>
                                                <tr>
                                                    <td><strong>UX</strong></td>
                                                    <td>5</td>
                                                    <td><input type="number" id="uxScore" name="uxScore" min="0" max="5" placeholder="0" oninput="calculateFinalScore()"></td>
                                                    <td><input type="text" id="uxReason" name="uxReason" placeholder="Enter reason"></td>
                                                </tr>
                                                <tr>
                                                    <td><strong>Cooperation</strong></td>
                                                    <td>10</td>
                                                    <td><input type="number" id="cooperationScore" name="cooperationScore" min="0" max="10" placeholder="0" oninput="calculateFinalScore()"></td>
                                                    <td><input type="text" id="cooperationReason" name="cooperationReason" placeholder="Enter reason"></td>
                                                </tr>
                                                <tr>
                                                    <td><strong>Critical Bugs</strong></td>
                                                    <td>0</td>
                                                    <td><input type="number" id="criticalBugsScore" name="criticalBugsScore" min="0" max="0" value="0" readonly class="readonly-field"></td>
                                                    <td><input type="text" id="criticalBugsReason" name="criticalBugsReason" placeholder="Enter reason"></td>
                                                </tr>
                                                <tr>
                                                    <td><strong>High Bugs</strong></td>
                                                    <td>15</td>
                                                    <td><input type="number" id="highBugsScore" name="highBugsScore" min="0" max="15" placeholder="0" oninput="calculateFinalScore()"></td>
                                                    <td><input type="text" id="highBugsReason" name="highBugsReason" placeholder="Enter reason"></td>
                                                </tr>
                                                <tr>
                                                    <td><strong>Medium Bugs</strong></td>
                                                    <td>10</td>
                                                    <td><input type="number" id="mediumBugsScore" name="mediumBugsScore" min="0" max="10" placeholder="0" oninput="calculateFinalScore()"></td>
                                                    <td><input type="text" id="mediumBugsReason" name="mediumBugsReason" placeholder="Enter reason"></td>
                                                </tr>
                                                <tr>
                                                    <td><strong>Low Bugs</strong></td>
                                                    <td>5</td>
                                                    <td><input type="number" id="lowBugsScore" name="lowBugsScore" min="0" max="5" placeholder="0" oninput="calculateFinalScore()"></td>
                                                    <td><input type="text" id="lowBugsReason" name="lowBugsReason" placeholder="Enter reason"></td>
                                                </tr>
                                            </tbody>
                                            <tfoot>
                                                <tr class="final-score-row">
                                                    <td><strong>Final Score</strong></td>
                                                    <td><strong>100</strong></td>
                                                    <td><strong><span id="finalScore">0</span></strong></td>
                                                    <td><strong>out of 100%</strong></td>
                                                </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                </div>

                                <div class="evaluation-chart-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-chart-pie"></i>
                                        <h3>Evaluation Scores Chart</h3>
                                    </div>
                                    <div class="info-card-v2-content">
                                        <div class="chart-container">
                                            <canvas id="evaluationChart" width="400" height="400"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Section 8: Automation Regression -->
                        <div class="section" id="section-8">
                            <h2 class="section-title"><i class="fas fa-robot"></i> Automation Regression</h2>

                            <div class="automation-layout">
                                <!-- Section 1: Test Cases Summary -->
                                <div class="automation-section-card automation-test-cases-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-chart-bar"></i>
                                        <h3>Test Cases Summary</h3>
                                    </div>
                                    <div class="automation-content-layout">
                                        <div class="automation-table-section">
                                            <table class="data-table" id="automationTestCasesTable">
                                                <thead>
                                                    <tr>
                                                        <th>Status</th>
                                                        <th>Count</th>
                                                        <th>Percentage</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td><strong>Total Test Cases</strong></td>
                                                        <td><input type="number" id="automationTotalTestCases" min="0"
                                                                placeholder="0" readonly
                                                                class="readonly-field calculated-total"></td>
                                                        <td class="percentage-cell">100%</td>
                                                    </tr>
                                                    <tr>
                                                        <td><i class="fas fa-check-circle text-success"></i> Passed</td>
                                                        <td><input type="number" id="automationPassedTestCases"
                                                                name="automationPassedTestCases" min="0" placeholder="0"
                                                                oninput="calculateAutomationPercentages()"></td>
                                                        <td class="percentage-cell" id="automationPassedPercentage">0%
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td><i class="fas fa-times-circle text-danger"></i> Failed</td>
                                                        <td><input type="number" id="automationFailedTestCases"
                                                                name="automationFailedTestCases" min="0" placeholder="0"
                                                                oninput="calculateAutomationPercentages()"></td>
                                                        <td class="percentage-cell" id="automationFailedPercentage">0%
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td><i class="fas fa-forward text-warning"></i> Skipped</td>
                                                        <td><input type="number" id="automationSkippedTestCases"
                                                                name="automationSkippedTestCases" min="0"
                                                                placeholder="0"
                                                                oninput="calculateAutomationPercentages()"></td>
                                                        <td class="percentage-cell" id="automationSkippedPercentage">0%
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="automation-chart-section">
                                            <div class="chart-container">
                                                <canvas id="automationTestCasesChart" width="400" height="400"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Section 2: Percentage Analysis -->
                                <div class="automation-section-card automation-percentage-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-percentage"></i>
                                        <h3>Percentage Analysis (Auto-calculated)</h3>
                                    </div>
                                    <div class="automation-content-layout">
                                        <div class="automation-table-section">
                                            <table class="data-table" id="automationPercentageTable">
                                                <thead>
                                                    <tr>
                                                        <th>Metric</th>
                                                        <th>Percentage</th>
                                                        <th>Notes</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td><i class="fas fa-check-circle text-success"></i> Passed Test
                                                            Cases</td>
                                                        <td><input type="number" id="automationPassedPercentageDisplay"
                                                                step="0.01" min="0" max="100" readonly
                                                                class="readonly-field">%</td>
                                                        <td><small>Percentage of total automation test cases</small>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td><i class="fas fa-times-circle text-danger"></i> Failed Test
                                                            Cases</td>
                                                        <td><input type="number" id="automationFailedPercentageDisplay"
                                                                step="0.01" min="0" max="100" readonly
                                                                class="readonly-field">%</td>
                                                        <td><small>Percentage of total automation test cases</small>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td><i class="fas fa-forward text-warning"></i> Skipped Test
                                                            Cases</td>
                                                        <td><input type="number" id="automationSkippedPercentageDisplay"
                                                                step="0.01" min="0" max="100" readonly
                                                                class="readonly-field">%</td>
                                                        <td><small>Percentage of total automation test cases</small>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="automation-chart-section">
                                            <div class="chart-container">
                                                <canvas id="automationPercentageChart" width="400"
                                                    height="400"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Section 3: Test Stability -->
                                <div class="automation-section-card automation-stability-card">
                                    <div class="info-card-v2-header">
                                        <i class="fas fa-balance-scale"></i>
                                        <h3>Test Stability Analysis</h3>
                                    </div>
                                    <div class="automation-content-layout">
                                        <div class="automation-table-section">
                                            <table class="data-table" id="automationStabilityTable">
                                                <thead>
                                                    <tr>
                                                        <th>Stability</th>
                                                        <th>Count</th>
                                                        <th>Percentage</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td><strong>Total Tests</strong></td>
                                                        <td><input type="number" id="automationStabilityTotal" min="0"
                                                                placeholder="0" readonly
                                                                class="readonly-field calculated-total"></td>
                                                        <td class="percentage-cell">100%</td>
                                                    </tr>
                                                    <tr>
                                                        <td><i class="fas fa-shield-alt text-success"></i> Stable</td>
                                                        <td><input type="number" id="automationStableTests"
                                                                name="automationStableTests" min="0" placeholder="0"
                                                                oninput="calculateAutomationStabilityPercentages()">
                                                        </td>
                                                        <td class="percentage-cell" id="automationStablePercentage">0%
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td><i class="fas fa-exclamation-triangle text-warning"></i>
                                                            Flaky</td>
                                                        <td><input type="number" id="automationFlakyTests"
                                                                name="automationFlakyTests" min="0" placeholder="0"
                                                                oninput="calculateAutomationStabilityPercentages()">
                                                        </td>
                                                        <td class="percentage-cell" id="automationFlakyPercentage">0%
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="automation-chart-section">
                                            <div class="chart-container">
                                                <canvas id="automationStabilityChart" width="400" height="400"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Section 9: QA Notes -->
                        <div class="section" id="section-9">
                            <h2 class="section-title"><i class="fas fa-note-sticky"></i> QA Notes</h2>
                            
                            <div class="qa-notes-container">
                                <div class="dynamic-list" id="qaNotesContainer">
                                    <div class="empty-state" id="emptyQANotesState">
                                        <div class="icon"><i class="fas fa-sticky-note"></i></div>
                                        <h3>No QA Notes Added</h3>
                                        <p>Click the "Add QA Note" button to start adding your notes.</p>
                                    </div>
                                </div>
                                
                                <div class="section-actions">
                                    <button type="button" class="btn btn-primary" onclick="openModal('addQANoteModal')">
                                        <i class="fas fa-plus"></i> Add QA Note
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Navigation Buttons -->
                        <div class="navigation-buttons">
                            <button type="button" class="nav-btn" id="prevBtn" onclick="previousSection()" disabled>
                                Previous</button>
                            <button type="button" class="nav-btn clear-btn" id="clearSectionBtn"
                                onclick="clearCurrentSection()">Clear Section</button>
                            <button type="button" class="nav-btn clear-btn" id="clearAllBtn"
                                onclick="clearAllFields()">Clear All</button>
                            <button type="button" class="nav-btn" id="nextBtn" onclick="nextSection()">Next </button>
                            <button type="submit" class="nav-btn submit-btn" id="submitBtn" style="display: none;">
                                Save Report</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Modals -->
    <!-- Portfolio Modal -->
    <div id="addPortfolioModal" class="modal">
        <div class="modal-content">
            <h3> Add New Portfolio</h3>
            <div class="modal-form">
                <div class="form-group">
                    <label for="newPortfolioName">Portfolio Name:</label>
                    <input type="text" id="newPortfolioName" placeholder="Enter portfolio name">
                </div>
            </div>
            <div class="modal-buttons">
                <button type="button" class="btn btn-secondary"
                    onclick="closeModal('addPortfolioModal')">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="addPortfolio()">Add Portfolio</button>
            </div>
        </div>
    </div>

    <!-- Project Modal -->
    <div id="addProjectModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-rocket"></i> Add New Project</h3>
            <div class="modal-form">
                <div class="form-group">
                    <label for="newProjectName">Project Name:</label>
                    <input type="text" id="newProjectName" placeholder="Enter project name">
                </div>
            </div>
            <div class="modal-buttons">
                <button type="button" class="btn btn-secondary" onclick="closeModal('addProjectModal')">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="addProject()">Add Project</button>
            </div>
        </div>
    </div>

    <!-- Request Modal -->
    <div id="requestModal" class="modal">
        <div class="modal-content">
            <h3> Add Request Information</h3>
            <div class="modal-form">
                <div class="form-group">
                    <label for="requestId">Request ID:</label>
                    <input type="text" id="requestId" placeholder="Enter request ID">
                </div>
                <div class="form-group">
                    <label for="requestUrl">Request URL:</label>
                    <input type="url" id="requestUrl" placeholder="Enter request URL">
                </div>
            </div>
            <div class="modal-buttons">
                <button type="button" class="btn btn-secondary" onclick="closeModal('requestModal')">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="addRequest()">Add Request</button>
            </div>
        </div>
    </div>

    <!-- Build Modal -->
    <div id="buildModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-hammer"></i> Add Build Information</h3>
            <div class="modal-form">
                <div class="form-group">
                    <label for="buildRequestId">Request ID:</label>
                    <input type="text" id="buildRequestId" placeholder="Enter request ID">
                </div>
                <div class="form-group">
                    <label for="buildRequestUrl">Request URL:</label>
                    <input type="url" id="buildRequestUrl" placeholder="Enter request URL">
                </div>
                <div class="form-group">
                    <label for="buildEnvironment">Environment:</label>
                    <input type="text" id="buildEnvironment" placeholder="Enter environment">
                </div>
                <div class="form-group">
                    <label for="buildCycles">Cycles:</label>
                    <input type="text" id="buildCycles" placeholder="Enter cycles">
                </div>
            </div>
            <div class="modal-buttons">
                <button type="button" class="btn btn-secondary" onclick="closeModal('buildModal')">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="addBuild()">Add Build</button>
            </div>
        </div>
    </div>

    <!-- Tester Modal -->
    <div id="testerModal" class="modal">
        <div class="modal-content">
            <h3> Select Tester</h3>
            <div class="modal-form">
                <div class="form-group">
                    <label for="existingTesterSelect">Select Tester:</label>
                    <select id="existingTesterSelect" onchange="handleTesterSelection()">
                        <option value="">-- Select a tester --</option>
                    </select>
                </div>
                <div class="form-group">
                    <p class="help-text">To add new testers, please use the <strong>Manage Data</strong> page.</p>
                </div>

            </div>
            <div class="modal-buttons">
                <button type="button" class="btn btn-secondary" onclick="closeModal('testerModal')">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="addSelectedTester()">Select Tester</button>
            </div>
        </div>
    </div>

    <!-- Team Member Modal -->
    <div id="teamMemberModal" class="modal">
        <div class="modal-content">
            <h3> Select Team Member</h3>
            <div class="modal-form">
                <div class="form-group">
                    <label for="existingTeamMemberSelect">Select Team Member:</label>
                    <select id="existingTeamMemberSelect">
                        <option value="">-- Select a team member --</option>
                    </select>
                </div>
                <div class="form-group">
                    <p class="help-text">To add new team members, please use the <strong>Manage Data</strong> page.</p>
                </div>
            </div>
            <div class="modal-buttons">
                <button type="button" class="btn btn-secondary" onclick="closeModal('teamMemberModal')">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="addSelectedTeamMember()">Select Team
                    Member</button>
            </div>
        </div>
    </div>

    <!-- QA Note Modal -->
    <div id="addQANoteModal" class="modal">
        <div class="modal-content">
            <h3> Add QA Note</h3>
            <div class="modal-form">
                <div class="form-group">
                    <label for="newQANoteText">Note:</label>
                    <textarea id="newQANoteText" placeholder="Enter your QA note here..." rows="4"></textarea>
                </div>
            </div>
            <div class="modal-buttons">
                <button type="button" class="btn btn-secondary" onclick="closeModal('addQANoteModal')">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="addQANote()">Add Note</button>
            </div>
        </div>
    </div>

    <!-- Auto-Load Project Data Modal -->
    <div id="autoLoadDataModal" class="modal">
        <div class="modal-content auto-load-modal">
            <h3><i class="fas fa-download"></i> Load Previous Project Data</h3>
            <p class="modal-description">We found previous reports for this project. Would you like to auto-fill the
                form with data from the latest report?</p>

            <div class="data-preview" id="dataPreview">
                <!-- Data preview will be populated by JavaScript -->
            </div>

            <div class="data-selection">
                <h4>Select data to load:</h4>
                <div class="checkbox-grid">
                    <label class="checkbox-item">
                        <input type="checkbox" id="loadSprintData" checked>
                        <span class="checkmark"></span>
                        Sprint & Release Information
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="loadReportData" checked>
                        <span class="checkmark"></span>
                        Report Information
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="loadTesters" checked>
                        <span class="checkmark"></span>
                        Tester(s) Information
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="loadTeamMembers" checked>
                        <span class="checkmark"></span>
                        Team Members
                    </label>
                </div>
            </div>

            <div class="modal-buttons">
                <button type="button" class="btn btn-secondary" onclick="closeModal('autoLoadDataModal')">Skip</button>
                <button type="button" class="btn btn-primary" onclick="loadSelectedData()">Load Selected Data</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Link to the external JavaScript files -->
    <script src="/static/enhanced_script.js"></script>
    <script src="/static/Charts.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            // Initialize theme first
            if (window.themeManager) {
                window.themeManager.init();
            }
            // Set active class for navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                if (link.getAttribute('href') === window.location.pathname) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });
            // Initialize form for new report
            resetFormData();
            loadFormDropdownData();
            initializeCharts(); // Ensure charts are initialized when the form page loads

            // Initialize progress bar and steps
            initializeProgressSteps();
            updateProgressBar();

            // Remove hardcoded width/height from chart canvases after initialization
            document.querySelectorAll('.chart-container canvas').forEach(canvas => {
                canvas.removeAttribute('width');
                canvas.removeAttribute('height');
            });

            // Check if there's a report ID in the URL for editing
            const urlParams = new URLSearchParams(window.location.search);
            const reportId = urlParams.get('id');
            if (reportId) {
                editingReportId = reportId;
                const report = await fetchReport(reportId);
                if (report) {
                    loadReportForEditing(report);
                    document.getElementById('formTitle').textContent = 'Edit QA Report';
                } else {
                    showToast('Report not found for editing.', 'error');
                    editingReportId = null; // Reset if not found
                }
            } else {
                document.getElementById('formTitle').textContent = 'Create Enhanced QA Report';

            }




            window.addEventListener('beforeunload', (event) => {
                // Only clear if we're not editing a report (to avoid clearing during editing)
                if (!editingReportId) {


                }
            });
        });

        // Function to update the report title based on custom name input
        function updateReportTitle() {
            const reportNameInput = document.getElementById('reportName');
            const formTitle = document.getElementById('formTitle');
            const customName = reportNameInput.value.trim();

            if (customName) {
                formTitle.textContent = customName;
            } else {
                // Use default based on editing state
                if (editingReportId) {
                    formTitle.textContent = 'Edit QA Report';
                } else {
                    formTitle.textContent = 'Create Enhanced QA Report';
                }
            }
        }
    </script>

</body>

</html>